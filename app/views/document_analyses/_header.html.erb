<%# Shared header for analysis sub-pages %>
<div class="bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
      <div>
        <div class="flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 mb-1">
          <%= link_to @document.title, @document, class: "hover:text-gray-700 dark:hover:text-gray-300" %>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" />
          </svg>
          <span>Analysis</span>
          <% if local_assigns[:page_title] %>
            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
              <path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z" />
            </svg>
            <span><%= page_title %></span>
          <% end %>
        </div>
        <h1 class="text-2xl font-bold text-gray-900 dark:text-gray-100"><%= local_assigns[:page_title] || 'Document Analysis' %></h1>
        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">
          by <%= link_to @document.user.display_name, @document.user, class: "text-gray-700 dark:text-gray-300 hover:underline" %>
          <% if @analysis.completed_at %>
            Â· Analyzed <%= time_ago_in_words(@analysis.completed_at) %> ago
          <% end %>
        </p>
      </div>
      <div class="flex items-center gap-3">
        <%= link_to edit_document_path(@document), class: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition" do %>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
          </svg>
          Edit Document
        <% end %>
        <%= link_to queue_analysis_document_path(@document), class: "inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-teal-600 hover:bg-teal-700 rounded-lg transition", data: { turbo_method: :post } do %>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
            <path d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z" />
          </svg>
          Re-analyze
        <% end %>
      </div>
    </div>
  </div>
</div>

<!-- Navigation Tabs -->
<%= render partial: 'documents/analysis/navigation', locals: { document: @document } %>

<li class="flex">
  <div class="flex items-center">
    <%= link_to main_app.thredded_path, class: 'px-2 py-1 -mx-2 -my-1 text-gray-400 hover:text-blue-500 rounded transition-colors' do %>
      <i class="material-icons flex-shrink-0 relative top-1">forum</i>
      <span class="sr-only">Home</span>
    <% end %>
  </div>
</li>

<% if messageboard_or_nil.try(:persisted?) %>
  <li class="flex">
    <div class="flex items-center">
      <svg class="flex-shrink-0 w-6 h-full text-gray-200" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
      </svg>
      <%= link_to messageboard.name, messageboard_topics_path(messageboard), class: 'ml-4 px-2 py-1 -mx-2 -my-1 text-sm font-medium text-gray-500 hover:text-blue-500 rounded transition-colors' %>
    </div>
  </li>
<% else %>
  <li class="flex">
    <div class="flex items-center">
      <svg class="flex-shrink-0 w-6 h-full text-gray-200" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
      </svg>
      <% if controller_name == 'private_topics' || controller_name == 'private_posts' %>
        <%= link_to 'Inbox', thredded.private_topics_path, class: 'ml-4 px-2 py-1 -mx-2 -my-1 text-sm font-medium text-gray-500 hover:text-blue-500 rounded transition-colors' %>
      <% else %>
        <%= link_to 'Notebook.ai Forums', root_path, class: 'ml-4 px-2 py-1 -mx-2 -my-1 text-sm font-medium text-gray-500 hover:text-blue-500 rounded transition-colors' %>
      <% end %>
    </div>
  </li>
<% end %>

<% # Check for topic on the page - multiple ways to find it %>
<% topic = nil %>
<% topic = @topic if defined?(@topic) && @topic.try(:persisted?) %>
<% topic = @posts.topic if !topic && defined?(@posts) && @posts.respond_to?(:topic) && @posts.topic.try(:persisted?) %>
<% topic = local_assigns[:topic] if !topic && defined?(local_assigns) && local_assigns[:topic].try(:persisted?) %>

<% if topic %>
  <li class="flex">
    <div class="flex items-center">
      <svg class="flex-shrink-0 w-6 h-full text-gray-200" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
      </svg>
      <span class="ml-4 px-2 py-1 -mx-2 -my-1 text-sm font-medium text-gray-700 truncate max-w-xs"><%= topic.title %></span>
    </div>
  </li>
<% end %>

<%
  status_colors = {
    'writing' => 'bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200',
    'revising' => 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200',
    'submitting' => 'bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200',
    'published' => 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'
  }
  status_color = status_colors[book.status] || status_colors['writing']
%>

<div
  class="group relative"
  x-show="searchQuery === '' || '<%= book.title.downcase.gsub("'", "\\'") %>'.includes(searchQuery.toLowerCase())"
>
  <%= link_to edit_book_path(book), class: "block" do %>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 overflow-hidden border border-gray-200 dark:border-gray-700">
      <!-- Book Cover Area -->
      <div class="h-40 w-full bg-gradient-to-br from-emerald-400 to-teal-500 flex items-center justify-center relative">
        <div class="text-center">
          <i class="material-icons text-white text-5xl opacity-80"><%= Book.icon %></i>
        </div>
        <!-- Status Badge -->
        <div class="absolute top-3 right-3">
          <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium <%= status_color %>">
            <%= book.status.humanize %>
          </span>
        </div>
      </div>

      <div class="p-4">
        <h2 class="text-lg font-semibold text-gray-900 dark:text-white line-clamp-1" title="<%= book.title %>">
          <%= book.title %>
        </h2>
        <% if book.subtitle.present? %>
          <p class="text-sm text-gray-500 dark:text-gray-400 line-clamp-1 mt-0.5">
            <%= book.subtitle %>
          </p>
        <% end %>

        <div class="mt-3 flex items-center justify-between text-sm">
          <span class="text-gray-500 dark:text-gray-400">
            <i class="material-icons text-sm align-middle mr-1">description</i>
            <%= pluralize book.documents.count, 'document' %>
          </span>
          <span class="text-gray-400 dark:text-gray-500 text-xs">
            Updated <%= time_ago_in_words(book.updated_at) %> ago
          </span>
        </div>
      </div>
    </div>
  <% end %>
</div>

<!-- Hero Header with Forest Background -->
<div class="relative bg-green-900 overflow-hidden">
  <!-- Background Pattern -->
  <div class="absolute inset-0 opacity-20">
    <div class="absolute inset-0" style="background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgdmlld0JveD0iMCAwIDYwIDYwIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiNmZmZmZmYiIGQ9Ik0zNiAzNGMwLTIuMi0xLjgtNC00LTRzLTQgMS44LTQgNCAxLjggNCA0IDQgNC0xLjggNC00eiIvPjxwYXRoIHN0cm9rZT0iI2ZmZmZmZiIgc3Ryb2tlLW9wYWNpdHk9Ii4yIiBzdHJva2Utd2lkdGg9IjIiIGQ9Ik0xIDFoNTh2NThIMXoiLz48L2c+PC9zdmc+'); background-repeat: repeat;"></div>
  </div>
  
  <!-- Forest Silhouette -->
  <div class="absolute bottom-0 left-0 right-0 h-32 bg-green-900">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320" class="absolute bottom-0">
      <path fill="#065f46" fill-opacity="1" d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,202.7C672,203,768,181,864,181.3C960,181,1056,203,1152,208C1248,213,1344,203,1392,197.3L1440,192L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
    </svg>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320" class="absolute bottom-0">
      <path fill="#064e3b" fill-opacity="0.8" d="M0,288L48,272C96,256,192,224,288,213.3C384,203,480,213,576,229.3C672,245,768,267,864,261.3C960,256,1056,224,1152,218.7C1248,213,1344,235,1392,245.3L1440,256L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
    </svg>
  </div>
  
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative">
    <!-- Header Content -->
    <div class="pt-16 pb-80 sm:pt-24 sm:pb-40 lg:pt-32 lg:pb-48">
      <div class="relative sm:max-w-3xl sm:mx-auto">
        <div class="text-center">
          <h1 class="text-4xl font-extrabold tracking-tight text-white sm:text-5xl lg:text-6xl">
            Our Environmental Impact
          </h1>
          <p class="mt-6 text-xl text-green-100 max-w-2xl mx-auto">
            Together, the Notebook.ai community is making a significant difference by choosing digital worldbuilding over paper
          </p>
          
          <!-- Animated Tree Icon -->
          <div class="mt-8 flex justify-center">
            <div class="relative h-24 w-24">
              <i class="material-icons absolute inset-0 text-green-400 animate-pulse" style="font-size: 6rem;">park</i>
              <i class="material-icons absolute inset-0 text-green-300 animate-pulse" style="font-size: 6rem; animation-delay: 1s;">park</i>
            </div>
          </div>
          
          <!-- Scroll Down Indicator -->
          <div class="mt-8 animate-bounce">
            <a href="#stats" class="text-green-200 hover:text-white">
              <span class="sr-only">Scroll down</span>
              <i class="material-icons">keyboard_arrow_down</i>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
  <!-- Key Stats Section -->
  <div id="stats" class="relative -mt-72">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden transform transition-all hover:scale-105">
        <div class="bg-gradient-to-br from-blue-500 to-blue-600 px-6 py-4 text-white">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-medium">Digital Ideas</h3>
            <i class="material-icons">auto_stories</i>
          </div>
        </div>
        <div class="p-6 text-center">
          <div class="text-4xl md:text-5xl font-bold text-gray-800 dark:text-white mb-2">
            <%= number_with_delimiter @total_notebook_pages %>
          </div>
          <div class="text-gray-600 dark:text-gray-300">
            Worldbuilding pages created
          </div>
        </div>
      </div>
      
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden transform transition-all hover:scale-105">
        <div class="bg-gradient-to-br from-amber-500 to-amber-600 px-6 py-4 text-white">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-medium">Paper Saved</h3>
            <i class="material-icons">description</i>
          </div>
        </div>
        <div class="p-6 text-center">
          <div class="text-4xl md:text-5xl font-bold text-gray-800 dark:text-white mb-2">
            <%= number_with_delimiter @total_pages_equivalent %>
          </div>
          <div class="text-gray-600 dark:text-gray-300">
            Sheets of paper saved
          </div>
        </div>
      </div>
      
      <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl overflow-hidden transform transition-all hover:scale-105">
        <div class="bg-gradient-to-br from-green-500 to-green-600 px-6 py-4 text-white">
          <div class="flex items-center justify-between">
            <h3 class="text-lg font-medium">Trees Saved</h3>
            <i class="material-icons">park</i>
          </div>
        </div>
        <div class="p-6 text-center">
          <div class="text-4xl md:text-5xl font-bold text-gray-800 dark:text-white mb-2">
            <%= number_with_delimiter @total_trees_saved.round %>
          </div>
          <div class="text-gray-600 dark:text-gray-300">
            Trees preserved
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-8 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 text-center">
      <h2 class="text-2xl font-bold text-gray-800 dark:text-white mb-4">Going Digital Makes a Difference</h2>
      <p class="text-xl text-gray-600 dark:text-gray-300 max-w-3xl mx-auto">
        Every page created on Notebook.ai directly contributes to less paper being used and fewer trees being cut down.
      </p>
      <div class="mt-4 text-sm text-gray-500 dark:text-gray-400">
        <i class="material-icons align-middle text-green-600 dark:text-green-400 mr-1">park</i>
        The average tree yields approximately <%= number_with_delimiter GreenService::SHEETS_OF_PAPER_PER_TREE %> sheets of paper
      </div>
    </div>
  </div>

  <!-- Environmental Impact Visualization -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden mb-8">
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Environmental Impact</h2>
      <p class="text-gray-600 dark:text-gray-400 mt-1">
        The positive effect of our community's digital worldbuilding
      </p>
    </div>
    
    <div class="p-6">
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8">
        <div class="bg-green-50 dark:bg-green-900 rounded-lg p-6 border border-green-100 dark:border-green-800">
          <div class="flex justify-between items-start">
            <div>
              <div class="text-sm text-gray-500 dark:text-gray-400 uppercase font-medium">Water Saved</div>
              <div class="text-3xl font-bold text-gray-800 dark:text-white mt-1">
                <%= number_with_delimiter((@total_pages_equivalent * 10 / 1000).round) %> gallons
              </div>
            </div>
            <div class="bg-green-100 dark:bg-green-800 rounded-full p-2">
              <i class="material-icons text-green-600 dark:text-green-300">water_drop</i>
            </div>
          </div>
          <div class="mt-4 text-sm text-gray-600 dark:text-gray-300">
            Paper production requires approximately 10 gallons of water per 1,000 sheets
          </div>
        </div>
        
        <div class="bg-blue-50 dark:bg-blue-900 rounded-lg p-6 border border-blue-100 dark:border-blue-800">
          <div class="flex justify-between items-start">
            <div>
              <div class="text-sm text-gray-500 dark:text-gray-400 uppercase font-medium">Energy Saved</div>
              <div class="text-3xl font-bold text-gray-800 dark:text-white mt-1">
                <%= number_with_delimiter((@total_pages_equivalent * 0.05 / 1000).round) %> kWh
              </div>
            </div>
            <div class="bg-blue-100 dark:bg-blue-800 rounded-full p-2">
              <i class="material-icons text-blue-600 dark:text-blue-300">bolt</i>
            </div>
          </div>
          <div class="mt-4 text-sm text-gray-600 dark:text-gray-300">
            Paper manufacturing is energy-intensive, requiring electricity and fuel
          </div>
        </div>
        
        <div class="bg-amber-50 dark:bg-amber-900 rounded-lg p-6 border border-amber-100 dark:border-amber-800">
          <div class="flex justify-between items-start">
            <div>
              <div class="text-sm text-gray-500 dark:text-gray-400 uppercase font-medium">Carbon Impact</div>
              <div class="text-3xl font-bold text-gray-800 dark:text-white mt-1">
                <%= number_with_delimiter((@total_trees_saved * 21).round) %> kg CO₂
              </div>
            </div>
            <div class="bg-amber-100 dark:bg-amber-800 rounded-full p-2">
              <i class="material-icons text-amber-600 dark:text-amber-300">co2</i>
            </div>
          </div>
          <div class="mt-4 text-sm text-gray-600 dark:text-gray-300">
            Trees saved can absorb approximately 21 kg of CO₂ annually
          </div>
        </div>
      </div>
      
      <div class="bg-gray-50 dark:bg-gray-700 rounded-lg p-6">
        <div class="flex items-center mb-4">
          <i class="material-icons text-green-600 dark:text-green-400 mr-2">forest</i>
          <h3 class="text-lg font-medium text-gray-800 dark:text-white">Visualizing Our Impact</h3>
        </div>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
          <div>
            <div class="mb-4 text-gray-700 dark:text-gray-300">
              <p>The trees saved by our community would cover approximately <%= (@total_trees_saved / 100).round(1) %> acres of forest.</p>
            </div>
            <div class="bg-green-100 dark:bg-green-900 rounded-lg p-6 flex justify-center">
              <div class="grid grid-cols-10 gap-2">
                <% (1..100).each do |i| %>
                  <% if i <= [@total_trees_saved / 10, 100].min %>
                    <i class="material-icons text-green-600 dark:text-green-400" style="font-size: 24px;">park</i>
                  <% else %>
                    <i class="material-icons text-gray-300 dark:text-gray-600" style="font-size: 24px;">park</i>
                  <% end %>
                <% end %>
              </div>
            </div>
          </div>
          
          <div>
            <div class="mb-10 text-gray-700 dark:text-gray-300">
              <h4 class="font-medium text-gray-800 dark:text-white">Paper Stack Height</h4>
              <p>Stacked, the paper saved would reach <%= (@total_pages_equivalent * 0.1 / 1000).round(1) %> kilometers high.</p>
            </div>
            
            <!-- Chart container with fixed height and overflow hidden -->
            <div class="bg-blue-100 dark:bg-blue-900 rounded-lg p-8 flex justify-center items-end h-64 relative overflow-hidden">
              <!-- Paper stack visualization with absolute height constraint -->
              <div class="w-32 bg-gradient-to-b from-blue-600 to-blue-500 rounded-t-lg shadow-lg" style="height: <%= [(@total_pages_equivalent / 100000.0) * 64, 64].min %>px; max-height: 100%;">
                <!-- Dark overlay for better text contrast -->
                <div class="absolute inset-0 bg-blue-800 bg-opacity-70 rounded-t-lg flex items-center justify-center">
                  <div class="text-center p-2">
                    <span class="text-white font-bold text-lg">
                      <%= number_with_delimiter @total_pages_equivalent %>
                    </span>
                    <div class="text-blue-100 text-sm">pages saved</div>
                  </div>
                </div>
              </div>
              
              <!-- Height marker lines -->
              <%
                max_height_km = (@total_pages_equivalent * 0.1 / 1000).round(1)
                # Use max_height_km or 0.1, whichever is larger, to avoid showing 0.0 km
                max_height_km = [max_height_km, 0.1].max
              %>
              <div class="absolute left-0 right-0 h-full flex flex-col justify-between pointer-events-none">
                <div class="border-t border-dashed border-blue-300 dark:border-blue-700 w-full relative">
                  <span class="absolute -top-3 left-2 text-xs text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-800 px-1 rounded"><%= max_height_km %> km</span>
                </div>
                <div class="border-t border-dashed border-blue-300 dark:border-blue-700 w-full relative">
                  <span class="absolute -top-3 left-2 text-xs text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-800 px-1 rounded"><%= (max_height_km / 2).round(2) %> km</span>
                </div>
                <div class="border-t border-dashed border-blue-300 dark:border-blue-700 w-full relative">
                  <span class="absolute -top-3 left-2 text-xs text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-800 px-1 rounded">0 km</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed Breakdown -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden mb-8">
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <h2 class="text-xl font-semibold text-gray-800 dark:text-white">Community Contribution Breakdown</h2>
      <p class="text-gray-600 dark:text-gray-400 mt-1">
        How different types of worldbuilding content contribute to our environmental impact
      </p>
    </div>
    
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200 dark:divide-gray-700">
        <thead class="bg-gray-50 dark:bg-gray-700">
          <tr>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Worldbuilding content</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Count</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Equivalent physical pages</th>
            <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Equivalent trees</th>
          </tr>
        </thead>

        <tbody class="bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700">
          <% (Rails.application.config.content_type_names[:all] + ["Timeline", "Document"]).each do |content_type| %>
            <%
              content_list_count       = @per_page_savings.dig(content_type, :digital)
              physical_page_equivalent = @per_page_savings.dig(content_type, :pages)
              tree_equivalent          = @per_page_savings.dig(content_type, :trees)
              
              # Skip if count is 0
              next if content_list_count == 0
            %>
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-700">
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <i class="material-icons text-<%= content_class_from_name(content_type).text_color %> mr-2">
                    <%= content_class_from_name(content_type).icon %>
                  </i>
                  <span class="text-gray-700 dark:text-gray-300 font-medium">
                    <% if ["Timeline", "Document"].include?(content_type) %>
                      <%= number_with_delimiter content_list_count %>
                      <%= content_type.pluralize content_list_count %>
                    <% else %>
                      <%= link_to send("#{content_type.downcase}_worldbuilding_info_path"), class: 'text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white' do %>
                        <%= number_with_delimiter content_list_count %>
                        <%= content_type.pluralize content_list_count %>
                      <% end %>
                    <% end %>
                  </span>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300">
                <%= number_with_delimiter content_list_count %>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <i class="material-icons text-gray-500 dark:text-gray-400 mr-2">copy_all</i>
                  <span class="text-gray-700 dark:text-gray-300">
                    <%= number_with_delimiter physical_page_equivalent %>
                    <%= 'page'.pluralize physical_page_equivalent %>
                  </span>
                </div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center">
                  <i class="material-icons text-green-600 dark:text-green-400 mr-2">park</i>
                  <span class="text-gray-700 dark:text-gray-300"><%= number_with_delimiter tree_equivalent.round(3) %> <%= 'tree'.pluralize tree_equivalent.round(3) %></span>
                </div>
              </td>
            </tr>
          <% end %>
          <tr class="bg-green-50 dark:bg-green-900">
            <td class="px-6 py-4 whitespace-nowrap font-medium text-gray-800 dark:text-white">Totals</td>
            <td class="px-6 py-4 whitespace-nowrap text-gray-700 dark:text-gray-300 font-medium">
              <%= number_with_delimiter @total_notebook_pages %>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center font-medium">
                <i class="material-icons text-gray-500 dark:text-gray-400 mr-2">copy_all</i>
                <span class="text-gray-800 dark:text-white">
                  <%= number_with_delimiter @total_pages_equivalent %>
                  <%= 'page'.pluralize @total_pages_equivalent %>
                </span>
              </div>
            </td>
            <td class="px-6 py-4 whitespace-nowrap">
              <div class="flex items-center font-medium">
                <i class="material-icons text-green-600 dark:text-green-400 mr-2">park</i>
                <span class="text-gray-800 dark:text-white">
                  <%= number_with_delimiter @total_trees_saved.round(3) %>
                  <%= 'tree'.pluralize @total_trees_saved.round(3) %>
                  saved
                </span>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  
  <!-- Calculation Methodology -->
  <div class="bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden mb-8">
    <div class="p-6 border-b border-gray-200 dark:border-gray-700">
      <h2 class="text-xl font-semibold text-gray-800 dark:text-white">How We Calculate Environmental Impact</h2>
      <p class="text-gray-600 dark:text-gray-400 mt-1">
        Understanding the methodology behind our environmental calculations
      </p>
    </div>
    
    <div class="p-6">
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div>
          <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Paper Equivalents</h3>
          <div class="space-y-4">
            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
              <div class="font-medium text-gray-800 dark:text-white mb-1">Content Type Equivalents</div>
              <p class="text-gray-600 dark:text-gray-300 text-sm">
                Different content types are equivalent to different amounts of paper:
              </p>
              <ul class="mt-2 space-y-1 text-sm text-gray-600 dark:text-gray-300">
                <li>• Characters: <%= GreenService.physical_pages_equivalent_for("Character") %> pages</li>
                <li>• Locations: <%= GreenService.physical_pages_equivalent_for("Location") %> pages</li>
                <li>• Items: <%= GreenService.physical_pages_equivalent_for("Item") %> pages</li>
                <li>• Documents: Based on word count (<%= GreenService::AVERAGE_WORDS_PER_PAGE %> words per page)</li>
                <li>• Timelines: <%= GreenService::AVERAGE_TIMELINE_EVENTS_PER_PAGE %> events per page</li>
              </ul>
            </div>
            
            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
              <div class="font-medium text-gray-800 dark:text-white mb-1">Tree Calculation</div>
              <p class="text-gray-600 dark:text-gray-300 text-sm">
                We use the industry standard of <%= GreenService::SHEETS_OF_PAPER_PER_TREE %> sheets of paper per tree.
                This accounts for the average yield of a tree used for paper production.
              </p>
            </div>
          </div>
        </div>
        
        <div>
          <h3 class="text-lg font-medium text-gray-800 dark:text-white mb-4">Environmental Impact</h3>
          <div class="space-y-4">
            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
              <div class="font-medium text-gray-800 dark:text-white mb-1">Water Usage</div>
              <p class="text-gray-600 dark:text-gray-300 text-sm">
                Paper production requires approximately 10 gallons of water per 1,000 sheets.
                This includes water used in pulping, processing, and cleaning.
              </p>
            </div>
            
            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
              <div class="font-medium text-gray-800 dark:text-white mb-1">Energy Consumption</div>
              <p class="text-gray-600 dark:text-gray-300 text-sm">
                We estimate 0.05 kilowatt-hours of electricity saved per 1,000 sheets of paper,
                based on average energy requirements for paper manufacturing.
              </p>
            </div>
            
            <div class="bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
              <div class="font-medium text-gray-800 dark:text-white mb-1">Carbon Impact</div>
              <p class="text-gray-600 dark:text-gray-300 text-sm">
                A mature tree absorbs approximately 21 kilograms of CO₂ per year.
                By saving trees, we're helping maintain this important carbon capture capacity.
              </p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="mt-6 bg-blue-50 dark:bg-blue-900 p-4 rounded-lg">
        <div class="flex items-center mb-2">
          <i class="material-icons text-blue-600 dark:text-blue-400 mr-2">info</i>
          <span class="text-gray-800 dark:text-white font-medium">Note on Calculations</span>
        </div>
        <p class="text-gray-600 dark:text-gray-300 text-sm">
          These calculations are estimates based on industry averages and research. The actual environmental impact may vary
          based on numerous factors including paper type, manufacturing processes, and tree species. Our goal is to provide
          a meaningful representation of the positive environmental effect of going digital with Notebook.ai.
        </p>
      </div>
    </div>
  </div>
  
  <!-- Share Section -->
  <div class="mt-8 bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-md p-6 text-white">
    <div class="flex flex-col md:flex-row items-center justify-between">
      <div class="mb-4 md:mb-0">
        <h3 class="text-xl font-bold mb-2">Share Our Environmental Impact</h3>
        <p>Help spread the word about how digital worldbuilding helps the environment!</p>
      </div>
      <div class="flex space-x-4">
        <button id="shareButton" class="inline-flex items-center px-4 py-2 border border-transparent text-base font-medium rounded-md shadow-sm text-green-700 bg-white hover:bg-green-50">
          <i class="material-icons mr-1">share</i>
          Share Impact
        </button>
      </div>
    </div>
  </div>
  
  <!-- Share Modal -->
  <div id="shareModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 z-50 flex items-center justify-center hidden">
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full mx-4">
      <div class="p-6 border-b border-gray-200 dark:border-gray-700">
        <div class="flex justify-between items-center">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-white">Share Our Environmental Impact</h3>
          <button id="closeShareModal" class="text-gray-400 hover:text-gray-500 dark:hover:text-gray-300">
            <i class="material-icons">close</i>
          </button>
        </div>
      </div>
      
      <div class="p-6">
        <p class="text-gray-600 dark:text-gray-300 mb-6">Share Notebook.ai's positive environmental impact with your network!</p>
        
        <div class="mb-6 bg-gray-50 dark:bg-gray-700 p-4 rounded-lg">
          <p class="text-gray-700 dark:text-gray-300 text-sm" id="shareMessagePreview"></p>
        </div>
        
        <div class="grid grid-cols-2 gap-4 mb-6">
          <a href="#" id="shareFacebook" class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base font-medium text-white bg-blue-600 hover:bg-blue-700">
            <i class="material-icons mr-2">facebook</i>
            Facebook
          </a>
          <a href="#" id="shareTwitter" class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base font-medium text-white bg-sky-500 hover:bg-sky-600">
            <i class="material-icons mr-2">flutter_dash</i>
            X / Twitter
          </a>
          <a href="#" id="shareLinkedIn" class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base font-medium text-white bg-blue-700 hover:bg-blue-800">
            <i class="material-icons mr-2">work</i>
            LinkedIn
          </a>
          <button id="copyShareText" class="flex items-center justify-center px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm text-base font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600">
            <i class="material-icons mr-2">content_copy</i>
            Copy Text
          </button>
        </div>
        
        <div class="flex justify-center">
          <button id="genericShareButton" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700">
            <i class="material-icons mr-2">share</i>
            Share via Device
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const shareButton = document.getElementById('shareButton');
      const shareModal = document.getElementById('shareModal');
      const closeShareModal = document.getElementById('closeShareModal');
      const shareMessagePreview = document.getElementById('shareMessagePreview');
      const shareFacebook = document.getElementById('shareFacebook');
      const shareTwitter = document.getElementById('shareTwitter');
      const shareLinkedIn = document.getElementById('shareLinkedIn');
      const copyShareText = document.getElementById('copyShareText');
      const genericShareButton = document.getElementById('genericShareButton');
      
      // Generate share text
      const treesCount = <%= @total_trees_saved.round %>;
      const pagesCount = <%= @total_pages_equivalent.round %>;
      
      const shareText = `The Notebook.ai community has saved ${treesCount} trees and ${pagesCount} sheets of paper through digital worldbuilding! #GoGreen #Worldbuilding`;
      
      const shareUrl = window.location.href;
      const shareTitle = 'Environmental Impact of Notebook.ai';
      
      // Update preview
      shareMessagePreview.textContent = shareText;
      
      // Open modal
      shareButton.addEventListener('click', function() {
        shareModal.classList.remove('hidden');
      });
      
      // Close modal
      closeShareModal.addEventListener('click', function() {
        shareModal.classList.add('hidden');
      });
      
      // Close modal when clicking outside
      window.addEventListener('click', function(event) {
        if (event.target === shareModal) {
          shareModal.classList.add('hidden');
        }
      });
      
      // Social media share links
      shareFacebook.addEventListener('click', function(e) {
        e.preventDefault();
        const facebookUrl = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareUrl)}&quote=${encodeURIComponent(shareText)}`;
        window.open(facebookUrl, '_blank');
      });
      
      shareTwitter.addEventListener('click', function(e) {
        e.preventDefault();
        const twitterUrl = `https://twitter.com/intent/tweet?text=${encodeURIComponent(shareText)}&url=${encodeURIComponent(shareUrl)}`;
        window.open(twitterUrl, '_blank');
      });
      
      shareLinkedIn.addEventListener('click', function(e) {
        e.preventDefault();
        const linkedInUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(shareUrl)}`;
        window.open(linkedInUrl, '_blank');
      });
      
      // Copy text button
      copyShareText.addEventListener('click', function() {
        const textarea = document.createElement('textarea');
        textarea.value = shareText;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        
        // Show feedback
        const originalText = copyShareText.innerHTML;
        copyShareText.innerHTML = '<i class="material-icons mr-2">check</i>Copied!';
        copyShareText.classList.add('bg-green-50', 'text-green-700');
        
        setTimeout(function() {
          copyShareText.innerHTML = originalText;
          copyShareText.classList.remove('bg-green-50', 'text-green-700');
        }, 2000);
      });
      
      // Web Share API
      genericShareButton.addEventListener('click', function() {
        if (navigator.share) {
          navigator.share({
            title: shareTitle,
            text: shareText,
            url: shareUrl,
          })
          .then(() => console.log('Successful share'))
          .catch((error) => console.log('Error sharing:', error));
        } else {
          // Fallback for browsers that don't support the Web Share API
          copyShareText.click();
        }
      });
    });
  </script>
</div>

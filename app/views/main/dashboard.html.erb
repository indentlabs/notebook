<div class="min-h-full">
  <div class="flex flex-col flex-1">
    <main class="flex-1 pb-8">
      <div class="bg-white shadow-md">
        <div class="px-4 sm:px-6 lg:max-w-6xl lg:mx-auto lg:px-8">
          <div class="py-6 md:flex md:items-center md:justify-between lg:border-t lg:border-gray-200">
            <div class="flex-1 min-w-0">
              <div class="flex items-center">
                <%= link_to current_user do %>
                  <%= image_tag current_user.image_url, class: 'hidden h-16 w-16 rounded-full sm:block border-2 border-green-700' %>
                <% end %>
                <div>
                  <div class="flex items-center">
                    <img class="h-16 w-16 rounded-full sm:hidden" src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2.6&w=256&h=256&q=80" alt="">
                    <h1 class="ml-3 text-2xl font-bold leading-7 text-gray-900 sm:leading-9 sm:truncate">
                      Welcome back, <%= link_to current_user.display_name, current_user, class: User.text_color %>!
                    </h1>
                  </div>
                  <dl class="mt-6 flex flex-col sm:ml-3 sm:mt-1 sm:flex-row sm:flex-wrap">
                    <dt class="sr-only">Company</dt>
                    <dd class="flex items-center text-sm text-gray-500 font-medium sm:mr-6">
                      <!-- Heroicon name: solid/office-building -->
                      <svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 110 2h-3a1 1 0 01-1-1v-2a1 1 0 00-1-1H9a1 1 0 00-1 1v2a1 1 0 01-1 1H4a1 1 0 110-2V4zm3 1h2v2H7V5zm2 4H7v2h2V9zm2-4h2v2h-2V5zm2 4h-2v2h2V9z" clip-rule="evenodd" />
                      </svg>
                      Today's goal: 0/3,000 words written
                    </dd>
                    <dt class="sr-only">Account status</dt>
                    <dd class="mt-3 flex items-center text-sm text-gray-500 font-medium sm:mr-6 sm:mt-0 capitalize">
                      <!-- Heroicon name: solid/check-circle -->
                      <svg class="flex-shrink-0 mr-1.5 h-5 w-5 text-green-400" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd" />
                      </svg>
                      [progress bar]
                    </dd>
                  </dl>
                </div>
              </div>
            </div>
            <div class="mt-6 flex space-x-3 md:mt-0 md:ml-4">
              <!--
              <button type="button" class="inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500">Data Vault</button>
              -->
              <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-500 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Discussions</button>
            </div>
          </div>
        </div>
      </div>

      <div class="py-8">
        <div class="max-w-6xl mx-auto">
          <!--
          <h2 class="text-lg leading-6 font-medium text-gray-900">Overview</h2>
          -->
          <div class="mt-2 mb-8 grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-3">
            <!-- Goals -->

            <div class="bg-white overflow-hidden shadow rounded-lg">
              <div class="p-5">
                <div class="flex items-center">
                  <div class="flex-shrink-0">
                    <i class="material-icons h-6 w-6 text-gray-400">date_range</i>
                  </div>
                  <div class="ml-5 w-0 flex-1">
                    <dl>
                      <dt class="text-sm font-medium text-gray-500 truncate">Weekly average</dt>
                      <dd class="pb-1">
                        <span
                          class="text-lg font-medium text-gray-900"
                          data-controller="animated-number"
                          data-animated-number-lazy-value=""
                          data-animated-number-start-value="0"
                          data-animated-number-end-value="2583"
                          data-animated-number-duration-value="500"
                        ></span> words per day
                      </dd>
                    </dl>
                  </div>
                </div>
              </div>
              <div class="bg-gray-50 px-5 py-3">
                <div class="text-sm">
                  <a href="#" class="font-medium text-notebook-blue hover:text-blue-700">
                    Some call-to-action
                  </a>
                </div>
              </div>
            </div>

            <div class="bg-white overflow-hidden shadow rounded-lg">
              <div class="p-5">
                <div class="flex items-center">
                  <div class="flex-shrink-0">
                    <i class="material-icons h-6 w-6 text-gray-400">calendar_month</i>
                  </div>
                  <div class="ml-5 w-0 flex-1">
                    <dl>
                      <dt class="text-sm font-medium text-gray-500 truncate">Words written this month</dt>
                      <dd class="pb-1">
                        <div
                          class="text-lg font-medium text-gray-900"
                          data-controller="animated-number"
                          data-animated-number-lazy-value=""
                          data-animated-number-start-value="0"
                          data-animated-number-end-value="33359"
                          data-animated-number-duration-value="500"
                        ></div>
                      </dd>
                    </dl>
                  </div>
                </div>
              </div>
              <div class="bg-gray-50 px-5 py-3">
                <div class="text-sm">
                  <a href="#" class="font-medium text-notebook-blue hover:text-blue-700">
                    View daily breakdown
                  </a>
                </div>
              </div>
            </div>

            <div class="bg-white overflow-hidden shadow rounded-lg">
              <div class="p-5">
                <div class="flex items-center">
                  <div class="w-0 flex-1">
                    <dl>
                      <dt class="text-sm font-medium text-gray-500 truncate">Your active writing streak</dt>
                      <dd>
                        <% 7.times.with_index do |i| %>
                          <%= link_to '#day-breakdown', class: 'group relative inline-block mt-2 mr-2' do %>
                            <span class="text-gray-600 bg-gray-200 group-hover:bg-gray-100 rounded-lg p-2 text-xs"><%= 25 + i %></span>
                            <span class="absolute top-0 right-0 inline-flex items-center justify-center px-1 py-1 text-xs font-bold leading-none transform translate-x-1/2 translate-y-1/4 rounded-full">
                              <i class="material-icons text-xl text-notebook-blue">check_circle</i>
                            </span>
                          <% end %>
                        <% end %>
                      </dd>
                    </dl>
                  </div>
                </div>
              </div>
              <div class="bg-gray-50 px-5 py-3">
                <div class="text-sm">
                  <a href="#" class="font-medium text-notebook-blue hover:text-blue-700">
                    You're on a 34-day streak!
                  </a>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Serendipitous prompt -->
        <div class="bg-white shadow-md">
          <div class="max-w-7xl mx-auto py-16 px-4 sm:py-24 sm:px-6 lg:px-8 lg:flex lg:justify-between space-x-0 md:space-x-16">
            <div class="w-full">
              <h2 class="text-sm font-extrabold text-gray-900 sm:tracking-tight mb-1">
                Expand
                <% if @universe_scope.present? %>
                  <%= link_to @universe_scope.name, @universe_scope, class: "#{Universe.text_color}" %>,
                <% else %>
                  your worlds,
                <% end %>
                one question at a time <!-- | little by little -->
              </h2>
              <%=
                if @content && @attribute_field_to_question
                  render partial: 'cards/serendipitous/tailwind_content_question', locals: { 
                    content: @content, 
                    field: @attribute_field_to_question,
                    expand_by_default: true,
                    include_quick_reference: false
                  }
                end
              %>
            </div>
            <div class="mt-10 w-full max-w-xs">
              <%= link_to '#', class: "#{@content.color} text-white block rounded-lg p-2 mb-1" do %>
                <i class="material-icons float-left ml-1 mr-3 text-4xl"><%= @content.icon %></i>
                <div class="text-xs ml-8">Quick-reference</div>
                <%= @content.name %>
              <% end %>

              <%= link_to prompts_path, class: "bg-orange-500 text-white block rounded-lg p-2" do %>
                <i class="material-icons float-left ml-1 mr-3 -mt-1 text-2xl">lightbulb</i>
                See more prompts
                <% if @universe_scope.present? %>
                  in this universe
                <% end %>
                <i class="material-icons float-right">arrow_right</i>
              <% end %>

              <p class="text-xs text-gray-500 mt-8">
                <i class="material-icons text-xs mr-1"><%= @content.icon %></i>
                Your answer will be automatically saved to your
                <span class="<%= @content.text_color %>"><%= @content.name %></span>
                <%= @content.page_type.downcase %> page.
              </p>
            </div>
          </div>
        </div>

        <h2 class="max-w-6xl mx-auto mt-8 px-4 text-lg leading-6 font-medium text-gray-900 sm:px-6 lg:px-8">
          Pick up where you left off
        </h2>
        <div class="max-w-6xl mx-auto pt-2">
          <ul role="list" class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
            <% @recently_edited_pages.first(9).each do |page| %>
              <% next if page.is_a?(Document) || page.is_a?(Timeline) %>

              <%= link_to page.edit_path do %>
                <li class="col-span-1 bg-white rounded-lg shadow divide-y divide-gray-200 hover:shadow-lg">
                  <div class="w-full flex items-center">
                    <div class="p-2">
                      <%= image_tag page.random_image_including_private, class: 'w-32 h-32 bg-notebook-blue rounded-lg flex-shrink-0' %>
                    </div>
                    <div class="flex-1 truncate p-4">
                      <div class="flex items-center space-x-3 mb-2">
                        <h3 class="text-gray-900 text-sm font-medium truncate <%= page.text_color %>">
                          <%= page.name %>
                        </h3>
                      </div>
                      <p class="text-gray-500 text-sm truncate">
                        word count
                      </p>
                      <p class="text-gray-500 text-sm truncate">
                        last edited <%= time_ago_in_words page.updated_at %> ago
                      </p>
                    </div>
                  </div>
                </li>
              <% end %>
            <% end %>
          </ul>
        </div>

        <h2 class="max-w-6xl mx-auto mt-8 px-4 text-lg leading-6 font-medium text-gray-900 sm:px-6 lg:px-8">Or create a new...</h2>
        <div class="pt-2 mx-4">
          <ul role="list" class="grid grid-cols-1 gap-6 sm:grid-cols-4 lg:grid-cols-10">
            <% (@activated_content_types + ["Timeline", "Document"]).each do |content_type| %>
              <% klass = content_class_from_name(content_type) %>
              <%= link_to send("new_#{content_type.downcase}_path") do %>
                <li class="col-span-1 <%= klass.color %> text-white py-6 rounded-lg shadow hover:shadow-lg">
                  <div class="w-full text-center">
                    <i class="material-icons text-6xl"><%= klass.icon %></i>
                    <div>
                      <%= content_type %>
                    </div>
                  </div>
                </li>
              <% end %>
            <% end %>
          </ul>
        </div>

      </div>
    </main>
  </div>
</div>

<%= render partial: 'javascripts/content_linking' %>

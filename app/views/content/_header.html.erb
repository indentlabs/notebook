<nav class="bg-white dark:bg-gray-800 py-1.5 border-b border-gray-200 dark:border-gray-700 flex fixed top-14 left-0 right-0 z-40 -mt-px transition-all duration-300" :class="{ 'lg:ml-56': showSidebar, 'ml-0': !showSidebar }" aria-label="Breadcrumb">
  <ol role="list" class="hidden sm:flex flex-1 mx-auto px-4 space-x-4 sm:px-6 lg:px-8">
    <li class="flex">
      <div class="flex items-center">
        <%= link_to root_path, class: 'text-gray-400 hover:text-gray-500' do %>
          <i class="material-icons flex-shrink-0 text-lg">dashboard</i>
          <span class="sr-only">Home</span>
        <% end %>
      </div>
    </li>

    <li class="hidden sm:flex">
      <div class="flex items-center">
        <svg class="flex-shrink-0 w-4 h-5 text-gray-200 dark:text-gray-600" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
        </svg>
        <%= link_to content.class_name.pluralize, send("#{content.class_name.downcase.pluralize}_path"), class: 'ml-4 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white' %>
      </div>
    </li>

    <li class="flex">
      <div class="flex items-center">
        <svg class="flex-shrink-0 w-4 h-5 text-gray-200 dark:text-gray-600" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
        </svg>
        <%= link_to content.name, content.raw_model, class: 'ml-4 text-sm font-medium text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white truncate max-w-[120px] sm:max-w-none', aria: { current: (current_page == :show ? 'page' : nil) }, data: { breadcrumb_name: true } %>
      </div>
    </li>

    <!-- Edit breadcrumb for edit pages -->
    <% if current_page == :edit %>
      <li class="flex">
        <div class="flex items-center">
          <svg class="flex-shrink-0 w-4 h-5 text-gray-200 dark:text-gray-600" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
          </svg>
          <span class="ml-4 text-sm font-medium text-gray-900 dark:text-white" aria-current="page">Edit</span>
        </div>
      </li>
    <% end %>

    <!-- Changelog breadcrumb for changelog pages -->
    <% if current_page == :changelog %>
      <li class="flex">
        <div class="flex items-center">
          <svg class="flex-shrink-0 w-4 h-5 text-gray-200 dark:text-gray-600" viewBox="0 0 24 44" preserveAspectRatio="none" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
            <path d="M.293 0l22 22-22 22h1.414l22-22-22-22H.293z" />
          </svg>
          <span class="ml-4 text-sm font-medium text-gray-900 dark:text-white" aria-current="page">Change History</span>
        </div>
      </li>
    <% end %>
  </ol>

  <!-- Mobile Page Title -->
  <div class="sm:hidden flex items-center px-4 flex-1 min-w-0">
    <h1 class="text-lg font-bold text-gray-900 dark:text-white truncate">
      <%= content.name %>
    </h1>
  </div>

  <div class="flex flex-row ml-auto items-center">
    <% if show_edit_controls && @content.updatable_by?(current_user) %>
      
      <!-- Primary Action Button -->
      <div class="mr-3">
        <% if current_page == :edit %>
          <!-- Edit page - Done Editing button -->
          <%= link_to @content do %>
            <button type="button" class="w-full bg-gray-600 border border-gray-600 rounded-md shadow-sm px-3 py-1 inline-flex items-center text-sm font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
              <i class="material-icons text-base mr-2">visibility</i>
              Done Editing
            </button>
          <% end %>
        <% else %>
          <!-- Show/Changelog page - Edit Page button -->
          <%= link_to polymorphic_path(@content, action: :edit) do %>
            <button type="button" class="w-full bg-notebook-blue border border-notebook-blue rounded-md shadow-sm px-3 py-1 inline-flex items-center text-sm font-medium text-gray-200 hover:bg-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
              <i class="material-icons text-base mr-2">edit</i>
              Edit Page
            </button>
          <% end %>
        <% end %>
      </div>



    <% end %>
  </div>
</nav>

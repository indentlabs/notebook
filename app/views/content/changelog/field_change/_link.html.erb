<%
  # Try to parse old/new into JSON so we can properly loop over each link code
  old_json = JSON.parse(old_value) rescue []
  new_json = JSON.parse(new_value) rescue []
%>

<div class="grid md:grid-cols-2 gap-4">
  <!-- Previous Value -->
  <div class="space-y-2">
    <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
      <div class="w-3 h-3 bg-red-400 rounded-full mr-2"></div>
      <span class="font-medium">Previous Links</span>
    </div>
    <div class="bg-red-50 dark:bg-gray-800 border border-red-200 dark:border-red-900 rounded-lg p-4 min-h-24">
      <div class="prose prose-sm max-w-none prose-red dark:prose-invert">
        <%= simple_format ContentFormatterService.show(
          text: old_json.map { |code| "&bull; [[#{code}]]" }.join("\n"),
          viewing_user: current_user
        ) %>
      </div>
    </div>
  </div>

  <!-- Current Value -->
  <div class="space-y-2">
    <div class="flex items-center text-sm text-gray-600 dark:text-gray-400">
      <div class="w-3 h-3 bg-green-400 rounded-full mr-2"></div>
      <span class="font-medium">Current Links</span>
    </div>
    <div class="bg-green-50 dark:bg-gray-800 border border-green-200 dark:border-green-900 rounded-lg p-4 min-h-24">
      <div class="prose prose-sm max-w-none prose-green dark:prose-invert">
        <%= simple_format ContentFormatterService.show(
          text: new_json.map { |code| "&bull; [[#{code}]]" }.join("\n"),
          viewing_user: current_user
        ) %>
      </div>
    </div>
  </div>
</div>